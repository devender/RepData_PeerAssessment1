---
title: "Reproducible Research: Peer Assessment 1"
author: "Devender R. Gollapally"
output: 
  html_document:
    keep_md: true
    
---

## Introduction

Using the data from a personal activity monitoring device this project we will try to answer the following questions:

1. **What is mean total number of steps taken per day ?**
2. **What is the average daily activity pattern ?**
3. **Are there differences in activity patterns between weekdays and weekends ?**

The device used, collects data at 5 minute intervals. The data consists of two months collected during the months of October and November, 2012 and include the number of steps taken each day.

## Data Source

The data used in this assignment can be downloaded from this [Link](https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip) on the course website, it is also included in the [github repository](https://github.com/devender/RepData_PeerAssessment1).

##### R workspace setup
```{r warning=FALSE,message=FALSE,results="hide"}
library(data.table)
library(dplyr)
library(ggplot2)

# Setup Working dir
setwd("/Users/Devender/RepData_PeerAssessment1")
# Clean up work space
rm(list=ls())
gc()
if(!file.exists("activity.csv")){
    unzip("activity.zip")
}
```

## Loading and preprocessing the data
Reading the CSV file into a data frame.
```{r}
activityData <- read.csv("activity.csv", header= T, na.strings = c("NA"))
str(activityData)
```

## What is mean total number of steps taken per day ?

Subsetting the data and grouping by each day, gives us total number of steps for each day.

```{r warning=FALSE}
stepsByDay <- activityData %>% 
                select(steps, date) %>% 
                filter(!is.na(steps)) %>%
                group_by(date) %>% 
                summarise(total_steps = sum(steps))
head(stepsByDay)
```
Using the above data we can plot a histogram of the total number of steps taken each day

```{r warning=FALSE}
ggplot(stepsByDay, aes(x=total_steps)) + 
    geom_histogram(colour="black", fill="white", bins=10)+
    xlab("Steps") +ylab("Frequency") +
    ggtitle("Total number of steps taken each day")
```

##### Calculate and report the mean and median of the total number of steps taken per day:
```{r}
mean(stepsByDay$total_steps)
median(stepsByDay$total_steps)
```

## What is the average daily activity pattern?
```{r}
avgActivityPattern <- activityData %>%
            select(steps,interval)%>%
            filter(!is.na(steps)) %>%
            group_by(interval) %>% 
            summarise(avg_steps = mean(steps))

ggplot(avgActivityPattern, aes(x=interval)) + 
    geom_line( aes(y=avg_steps)) +
    xlab("Interval of Day") +ylab("Average Number of Steps") +
    ggtitle("Avg Daily Activity Pattern")
```


## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
